<!-- 
    Created By : {Girikon(Abhishek)}
    Created On : 26 Aug 2019
    @description : [C2E-14] - It is used to display Manuals tab of Agent Owned Exhibitor to Agent.
    Modified By : {Girikon(Prashant) 17 Oct 2019}, [Aishwarya BK-4682 5 june 2020]
-->
<template>
  <lightning-card title={requiredManualsLabel} style="font-weight: bold;">
    <div style="overflow:auto">
      <table class="slds-table slds-table_cell-buffer slds-table_bordered">
        <thead>
          <tr class="slds-line-height_reset">
            <th
              class="tabHeader"
              data-index="1"
              data-table-type="required"
              onclick={sortTable}
              style="width:40%;background-color: #ebebeb; cursor: pointer;"
            >
              {formNameLabel}
            </th>
            <th
              class="tabHeader"
              scope="col"
              data-index="2"
              data-table-type="required"
              onclick={sortTable}
              style="width:20%;background-color: #ebebeb; cursor: pointer;"
            >
              {providerLabel}
            </th>
            <th
              class="tabHeader"
              data-index="3"
              data-table-type="required"
              onclick={sortTable}
              scope="col"
              style="background-color: #ebebeb; cursor: pointer;"
            >
              {deadLineLabel}
            </th>
            <th
              class="tabHeader"
              data-index="4"
              data-table-type="required"
              onclick={sortTable}
              scope="col"
              style="background-color: #ebebeb; cursor: pointer;"
            >
              {viewedLabel}
            </th>
            <th
              class="tabHeader"
              data-index="5"
              data-table-type="required"
              onclick={sortTable}
              scope="col"
              style="background-color: #ebebeb; cursor: pointer;"
            >
              {agreedLabel}
            </th>
            <th
              class=""
              scope="col"
              style="background-color: #ebebeb; cursor: pointer;"
            ></th>
          </tr>
        </thead>
        <tbody>
          <template if:true={requiredManuals}>
            <template for:each={requiredManuals} for:item="requiredManual">
              <tr
                class="slds-hint-parent"
                key={requiredManual.Id}
                style="font-weight: 500;"
              >
                <td>
                  <template if:true={requiredManual.isNotALink}>
                    <a
                      href=""
                      data-mid={requiredManual.Id}
                      data-manualtype="required"
                      onclick={showClickedManual}
                      style="text-decoration: none; font-weight:500;"
                      >{requiredManual.Manual_Permission__r.Manuals__r.Name}</a
                    >
                  </template>
                  <template if:false={requiredManual.isNotALink}>
                    <a
                      href=""
                      data-mid={requiredManual.Id}
                      data-manualtype="required"
                      onclick={navigateToManualLink}
                      style="text-decoration: none; font-weight:500;"
                      >{requiredManual.Manual_Permission__r.Manuals__r.Name}</a
                    >
                  </template>
                </td>
                <td>
                  {requiredManual.Manual_Permission__r.Manuals__r.Provider__c}
                </td>
                <td>
                  {requiredManual.deadline}
                </td>
                <td>
                    <template if:true={requiredManual.Is_Viewed__c}>
                      <lightning-icon
                        icon-name="utility:check"
                        size="xx-small"
                        alternative-text="Yes"
                      ></lightning-icon>
                    </template>
                </td>
                <td>
                  <template if:true={requiredManual.isNotALink}>
                    <template if:true={requiredManual.Is_Agree__c}>
                      <lightning-icon
                        icon-name="utility:check"
                        size="xx-small"
                        alternative-text="Yes"
                      ></lightning-icon>
                    </template>
                  </template>
                </td>
                <td>
                  <div class="slds-text-color_weak" >
                    <i>{requiredManual.lastModifiedByString}</i>
                  </div>
                </td>
              </tr>
            </template>
          </template>
        </tbody>
      </table>
    </div>
  </lightning-card>
  <br /><br />
  <lightning-card title={additionalManualsLabel} style="font-weight: bold;">
    <div style="overflow: auto">
      <table class="slds-table slds-table_cell-buffer slds-table_bordered">
        <thead>
          <tr class="slds-line-height_reset">
            <th
              class="tabHeader"
              data-index="1"
              data-table-type="additional"
              onclick={sortTable}
              style="width:40%;background-color: #ebebeb; cursor: pointer;"
            >
              {formNameLabel}
            </th>
            <th
              class="tabHeader"
              data-index="2"
              data-table-type="additional"
              onclick={sortTable}
              scope="col"
              style="width:20%;background-color: #ebebeb; cursor: pointer;"
            >
              {providerLabel}
            </th>
            <th
              class="tabHeader"
              data-index="3"
              data-table-type="additional"
              onclick={sortTable}
              scope="col"
              style="background-color: #ebebeb; cursor: pointer;"
            >
              {deadLineLabel}
            </th>
            <th
              class="tabHeader"
              data-index="4"
              data-table-type="additional"
              onclick={sortTable}
              scope="col"
              style="background-color: #ebebeb; cursor: pointer;"
            >
              {viewedLabel}
            </th>
            <th
              class="tabHeader"
              data-index="5"
              data-table-type="additional"
              onclick={sortTable}
              scope="col"
              style="background-color: #ebebeb; cursor: pointer;"
            >
              {agreedLabel}
            </th>
            <th
              class=""
              scope="col"
              style="background-color: #ebebeb; cursor: pointer;"
            ></th>
          </tr>
        </thead>
        <tbody>
          <template if:true={additionalManuals}>
            <template for:each={additionalManuals} for:item="additionalManual">
              <tr
                class="slds-hint-parent"
                key={additionalManual.Id}
                style="font-weight: 500;"
              >
                <td>
                  <template if:true={additionalManual.isNotALink}>
                    <a
                      href=""
                      data-mid={additionalManual.Id}
                      data-manualtype="additional"
                      style="text-decoration: none; font-weight:500;"
                      onclick={showClickedManual}
                      >{additionalManual.Manual_Permission__r.Manuals__r.Name}</a
                    >
                  </template>
                  <template if:false={additionalManual.isNotALink}>
                    <a
                      href=""
                      data-mid={additionalManual.Id}
                      data-manualtype="additional"
                      onclick={navigateToManualLink}
                      style="text-decoration: none; font-weight:500;"
                      >{additionalManual.Manual_Permission__r.Manuals__r.Name}</a
                    >
                  </template>
                </td>
                <td>
                  {additionalManual.Manual_Permission__r.Manuals__r.Provider__c}
                </td>
                <td>
                  {additionalManual.deadline}
                </td>
                <td>
                    <template if:true={additionalManual.Is_Viewed__c}>
                      <lightning-icon
                        icon-name="utility:check"
                        size="xx-small"
                        alternative-text="Yes"
                      ></lightning-icon>
                    </template>
                </td>
                <td>
                  <template if:true={additionalManual.isNotALink}>
                    <template if:true={additionalManual.Is_Agree__c}>
                      <lightning-icon
                        icon-name="utility:check"
                        size="xx-small"
                        alternative-text="Yes"
                      ></lightning-icon>
                    </template>
                  </template>
                </td>
                <td>
                  <div class="slds-text-color_weak">
                    <i>{additionalManual.lastModifiedByString}</i>
                  </div>
                </td>
              </tr>
            </template>
          </template>
        </tbody>
      </table>
    </div>
  </lightning-card>

  <!-- Manual View Modal Start -->
  <template if:true={showManualFlag}>
    <section
      role="dialog"
      tabindex="-1"
      aria-labelledby="manual-heading"
      aria-modal="true"
      aria-describedby="manual-content"
      class="slds-modal slds-modal--large slds-fade-in-open customModal"
    >
      <div class="slds-modal__container">
        <!-- modal body start -->
        <div
          class="slds-modal__content slds-p-around_medium"
          id="manual-content"
        >
          <template if:true={isAllowedToView}>
            <iframe
              width="100%"
              style="min-height: 60vh;"
              src={manualURL}
            ></iframe>
          </template>
          <template if:false={isAllowedToView}>
            <div class="slds-text-align_center">
              <span
                style="font-weight:bold"
                class="slds-text-align_center slds-text-color_destructive slds-text-heading_medium"
              >
                {manualExpiredLabel}
              </span>
            </div>
          </template>
          <div class="clearfix">
            <div class="slds-float_left">
              <template if:true={isAllowedToView}>
                <div class="slds-m-top_large CustomMarginBtn ">
                  {readAndAgreeLabel}&nbsp;&nbsp;&nbsp;
                  <template if:true={disableReadAndAgree}>
                    <input
                      disabled
                      checked={currentManual.Is_Agree__c}
                      name="agreeToContents"
                      type="checkbox"
                      onclick={checkManual}
                    />
                  </template>
                  <template if:false={disableReadAndAgree}>
                    <input
                      name="agreeToContents"
                      type="checkbox"
                      onclick={checkManual}
                    />
                  </template>
                </div>
              </template>
            </div>
            <div class="slds-float_right">
              <div class="slds-m-top_large CustomMarginBtn ">
                <template if:true={isAllowedToView}>
                  <lightning-icon
                    icon-name="utility:download"
                    alternative-text="Download"
                    size="xx-small"
                  ></lightning-icon
                  >&nbsp;
                  <a
                    href={manualDownloadURL}
                    target="_blank"
                    download={currentManual.Manual_Permission__r.Manuals__r.Name}
                    class="slds-m-right_large"
                  >
                    {downloadLabel}&nbsp;{pdfLabel}
                  </a>
                  <template if:true={enableSaveBtn}>
                    <lightning-button
                      variant="brand"
                      class="slds-m-left_medium"
                      onclick={saveManual}
                      label={saveLabel}
                    ></lightning-button>
                  </template>
                  <template if:false={enableSaveBtn}>
                    <lightning-button
                      variant="brand"
                      disabled
                      class="slds-m-left_medium"
                      onclick={saveManual}
                      label={saveLabel}
                    ></lightning-button>
                  </template>
                </template>
                <lightning-button
                  variant="brand"
                  onclick={hideManual}
                  class="slds-m-left_medium"
                  label={cancelLabel}
                ></lightning-button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <div class="slds-backdrop slds-backdrop_open"></div>
  </template>
  <!-- Manual View Modal End -->
</template>